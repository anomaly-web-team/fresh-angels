/*! jquery-pjax v2.28.1 | (c) 2012, falsandtru | MIT Licence */
!new function(window,document,undefined,$){"use strict";var MODULE;!function(a){var b;!function(a){a.NAME="pjax",a.NAMESPACE=jQuery}(b=a.DEF||(a.DEF={}))}(MODULE||(MODULE={}));var MODULE;!function(a){!function(a){a[a.blank=0]="blank",a[a.initiate=1]="initiate",a[a.open=2]="open",a[a.pause=3]="pause",a[a.lock=4]="lock",a[a.seal=5]="seal",a[a.error=6]="error",a[a.crash=7]="crash",a[a.terminate=8]="terminate",a[a.close=9]="close"}(a.State||(a.State={}));a.State;a.EVENT={CLICK:"click",SUBMIT:"submit",POPSTATE:"popstate",SCROLL:"scroll"}}(MODULE||(MODULE={}));var MODULE;!function(a){var b;!function(){}(b=a.MODEL||(a.MODEL={}))}(MODULE||(MODULE={}));var MODULE;!function(a){var b;!function(a){var b;!function(){}(b=a.APP||(a.APP={}))}(b=a.MODEL||(a.MODEL={}))}(MODULE||(MODULE={}));var MODULE;!function(a){var b;!function(a){var b;!function(a){var b;!function(){}(b=a.DATA||(a.DATA={}))}(b=a.APP||(a.APP={}))}(b=a.MODEL||(a.MODEL={}))}(MODULE||(MODULE={}));var MODULE;!function(a){function b(a,b){for(var c=a.prototype,d=b.length;d--;){var e=b[d].prototype;for(var f in e)"constructor"!==f&&e.hasOwnProperty(f)&&(c[f]=e[f])}}function c(){function a(a){var b=16*Math.random()|0,c="x"==a?b:3&b|8;return c.toString(16).toUpperCase()}return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,a)}function d(a,b){if(!Object.freeze||a===a.window||"ownerDocument"in a)return a;if(!Object.isFrozen(a)&&Object.freeze(a),!b)return a;for(var c in a){var e=a[c];~"object,function".indexOf(typeof e)&&e&&d(e,b)}return a}function e(a,b){if(!Object.seal||a===a.window||"ownerDocument"in a)return a;if(!Object.isSealed(a)&&Object.seal(a),!b)return a;for(var c in a){var d=a[c];~"object,function".indexOf(typeof d)&&d&&e(d,b)}return a}a.MIXIN=b,a.UUID=c,a.FREEZE=d,a.SEAL=e}(MODULE||(MODULE={}));var MODULE;!function(){}(MODULE||(MODULE={}));var MODULE;!function(a){var b;!function(b){var c=function(){function b(b){this.NAME=a.DEF.NAME,this.NAMESPACE=a.DEF.NAMESPACE,this.UUID=a.UUID(),this.state_=0,this.state_=b}return b.prototype.MAIN=function(a){for(var b=[],c=1;c<arguments.length;c++)b[c-1]=arguments[c];return this.main_.apply(this,[a].concat(b))},b.prototype.main_=function(a){for(var b=[],c=1;c<arguments.length;c++)b[c-1]=arguments[c];return a},b}();b.Template=c}(b=a.MODEL||(a.MODEL={}))}(MODULE||(MODULE={}));var MODULE;!function(a){var b;!function(b){var c=function(){function b(b){this.UUID=a.UUID(),this.state_=0,this.state_=b}return b}();b.Template=c}(b=a.VIEW||(a.VIEW={}))}(MODULE||(MODULE={}));var __extends=this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);c.prototype=b.prototype,a.prototype=new c},MODULE;!function(a){var b;!function(b){var c=function(b){function c(c,d,e,f){var g=this;b.call(this,1),this.model_=c,this.controller_=d,this.context_=e,this.handlers={click:function(){g.controller_.click(arguments)},submit:function(){g.controller_.submit(arguments)},popstate:function(){g.controller_.popstate(arguments)},scroll:function(){g.controller_.scroll(arguments)}},a.FREEZE(this),this.observe_(f)}return __extends(c,b),c.prototype.observe_=function(a){return this.release_(a),this.context_.delegate(a.link,a.nss.click,this.handlers.click).delegate(a.form,a.nss.submit,this.handlers.submit),jQuery(window).bind(a.nss.popstate,this.handlers.popstate),a.database&&a.fix.scroll&&jQuery(window).bind(a.nss.scroll,this.handlers.scroll),this},c.prototype.release_=function(a){return this.context_.undelegate(a.link,a.nss.click).undelegate(a.form,a.nss.submit),jQuery(window).unbind(a.nss.popstate),a.database&&a.fix.scroll&&jQuery(window).unbind(a.nss.scroll),this},c}(b.Template);b.Main=c}(b=a.VIEW||(a.VIEW={}))}(MODULE||(MODULE={}));var MODULE;!function(a){a.View=a.VIEW.Main}(MODULE||(MODULE={}));var MODULE;!function(a){var b;!function(b){var c=function(){function b(){a.FREEZE(this)}return b.prototype.enable=function(){return a.Model.singleton().enable(),this},b.prototype.disable=function(){return a.Model.singleton().disable(),this},b.prototype.click=function(b,c){var d;switch(typeof b){case"undefined":d=jQuery(this).filter("a").first().clone();break;case"object":d=jQuery(b).clone();break;case"string":c=jQuery.extend(!0,{},c,{href:b}),d=jQuery("<a/>",c);break;default:return this}var e=a.Model.singleton().configure(d[0]);return e&&d.first().one(e.nss.click,function(){return a.Controller.singleton().click(arguments)}).click(),this},b.prototype.submit=function(b,c,d){var e,f,g,h=document.createDocumentFragment();switch(typeof b){case"undefined":e=jQuery(this).filter("form").first().clone();break;case"object":e=jQuery(b).clone();break;case"string":c=jQuery.extend(!0,{},c,{action:b}),f=d instanceof Array&&Array||d instanceof Object&&Object||undefined;for(var i in d){switch(f){case Object:if(!Object.prototype.hasOwnProperty.call(d,i))continue;g=jQuery("<textarea/>",{name:i}).val(d[i]);break;case Array:d[i].attrs=d[i].attrs||{},d[i].attrs.name=d[i].name||d[i].attrs.name,d[i].attrs.type=d[i].type||d[i].attrs.type,g=jQuery("<"+d[i].tag+"/>",d[i].attrs).val(d[i].value);break;default:continue}h.appendChild(g[0])}e=jQuery("<form/>",c).append(h);break;default:return this}var j=a.Model.singleton().configure(e[0]);return j&&e.first().one(j.nss.submit,function(){return a.Controller.singleton().submit(arguments)}).submit(),this},b.prototype.getCache=function(b){void 0===b&&(b=window.location.href);var c=a.Model.singleton().getCache(b);return c&&(c={data:c.data,textStatus:c.textStatus,jqXHR:c.jqXHR,expires:c.expires}),c},b.prototype.setCache=function(b,c,d,e){switch(void 0===b&&(b=window.location.href),arguments.length){case 0:return this.setCache(b,document.documentElement.outerHTML);case 1:return this.setCache(b,null);case 2:case 3:case 4:default:a.Model.singleton().setCache(b,c,d,e)}return this},b.prototype.removeCache=function(b){return void 0===b&&(b=window.location.href),a.Model.singleton().removeCache(b),this},b.prototype.clearCache=function(){return a.Model.singleton().clearCache(),this},b.prototype.follow=function(b,c,d,e){if(!a.Model.singleton().isDeferrable)return!1;var f=b.currentTarget;return c.follow=!0,c.host=d||"",isFinite(b.timeStamp)&&(c.timeStamp=e||b.timeStamp),a.Model.singleton().setXHR(c),jQuery.when(c).done(function(){!a.Model.singleton().getCache(f.href)&&a.Model.singleton().isAvailable(b)&&a.Model.singleton().setCache(f.href,undefined,undefined,c)}),jQuery[a.DEF.NAME].click(f.href),!0},b.prototype.host=function(){return a.Model.singleton().host()},b}();b.Functions=c}(b=a.CONTROLLER||(a.CONTROLLER={}))}(MODULE||(MODULE={}));var MODULE;!function(a){var b;!function(b){var c=function(){function b(){a.FREEZE(this)}return b}();b.Methods=c}(b=a.CONTROLLER||(a.CONTROLLER={}))}(MODULE||(MODULE={}));var MODULE;!function(a){var b;!function(b){var c=function(){function b(b,c){this.UUID=a.UUID(),this.state_=0,this.PROPERTIES=[],this.state_=c}return b.prototype.EXTEND=function(b){return b instanceof a.DEF.NAMESPACE?(b instanceof jQuery&&(b=b.add()),this.REGISTER_FUNCTION(b),this.REGISTER_METHOD(b)):(b!==this.EXTENSION&&(b=this.EXTENSION),this.REGISTER_FUNCTION(b)),this.UPDATE_PROPERTIES(b),b},b.prototype.REGISTER=function(b){var c=this;this.EXTENSION=this.EXTENSION||function(){for(var a=[],d=0;d<arguments.length;d++)a[d-0]=arguments[d];var e=c.EXTEND(this);return a=[e].concat(a),a=c.EXEC.apply(c,a),a instanceof Array?b.MAIN.apply(b,a):a},this.EXTEND(this.EXTENSION),window[a.DEF.NAMESPACE]=window[a.DEF.NAMESPACE]||{},a.DEF.NAMESPACE[a.DEF.NAME]=a.DEF.NAMESPACE.prototype?a.DEF.NAMESPACE.prototype[a.DEF.NAME]=this.EXTENSION:this.EXTENSION},b.prototype.EXEC=function(){return this.exec_.apply(this,arguments)},b.prototype.exec_=function(a){for(var b=[],c=1;c<arguments.length;c++)b[c-1]=arguments[c];return[a].concat(b)},b.prototype.REGISTER_FUNCTION=function(a){var b=this.FUNCTIONS;for(var c in b)"constructor"!==c&&(a[c]=b[c]);return a},b.prototype.REGISTER_METHOD=function(a){var b=this.METHODS;for(var c in b)"constructor"!==c&&(a[c]=b[c]);return a},b.prototype.UPDATE_PROPERTIES=function(a){var b,c,d,e=this.PROPERTIES;for(b=0,c=e.length;c>b;b++)"constructor"!==b&&(d=e[b],a[d]&&(a[d]=a[d]()));return a},b}();b.Template=c}(b=a.CONTROLLER||(a.CONTROLLER={}))}(MODULE||(MODULE={}));var MODULE;!function(a){var b;!function(b){var c=function(c){function d(d){c.call(this,d,1),this.model_=d,this.FUNCTIONS=new b.Functions,this.METHODS=new b.Methods,this.REGISTER(d),a.FREEZE(this)}return __extends(d,c),d.prototype.exec_=function(a){var b=[].slice.call(arguments,1,2),c=b[0];switch(typeof c){case"undefined":case"object":break;default:return a}return[a].concat(b)},d.prototype.view=function(b,c){return new a.View(this.model_,this,b,c)},d.prototype.click=function(a){this.model_.click.apply(this.model_,a)},d.prototype.submit=function(a){this.model_.submit.apply(this.model_,a)},d.prototype.popstate=function(a){this.model_.popstate.apply(this.model_,a)},d.prototype.scroll=function(a){this.model_.scroll.apply(this.model_,a)},d}(b.Template);b.Main=c;var d=function(){function b(d){void 0===d&&(d=a.Model.singleton()),b.instance_=b.instance_||new c(d)}return b.singleton=function(){return b.instance_},b.prototype.singleton=function(){return b.singleton()},b}();b.Singleton=d}(b=a.CONTROLLER||(a.CONTROLLER={}))}(MODULE||(MODULE={}));var MODULE;!function(a){a.Controller=a.CONTROLLER.Singleton}(MODULE||(MODULE={}));var MODULE;!function(a){var b;!function(a){var b=function(){function a(a,b){void 0===a&&(a=1),void 0===b&&(b=0),this.list_=[],this.config_={mode:1,size:0},this.table_={},this.option_={},this.config_.mode=a||this.config_.mode,this.config_.size=b||this.config_.size}return a.prototype.define=function(a,b,c){void 0===b&&(b=this.config_.mode),void 0===c&&(c=this.config_.size),this.option_[a]={mode:b,size:c},this.table_[a]=[]},a.prototype.reserve=function(a,b){switch(typeof a){case"string":!this.option_[a]&&this.define(a);var c=this.option_[a],d=this.table_[a],e=[].slice.call(arguments,2);break;case"function":b=a,a=undefined;var c=this.config_,d=this.list_,e=[].slice.call(arguments,1);break;default:return}if("function"==typeof b){var f;f=c.mode>0?"push":"unshift",d[f]([b,e.shift(),e])}},a.prototype.digest=function(a,b){switch(typeof a){case"string":!this.option_[a]&&this.define(a),b=b||0;var c=this.option_[a],d=this.table_[a];if(!d)return;break;case"number":case"undefined":b=a||0,a=undefined;var c=this.config_,d=this.list_;break;default:return}d.length>c.size&&c.size&&(c.mode>0?d.splice(0,d.length-c.size):d.splice(d.length-c.size,d.length));var e;for(b=b||-1;e=b--&&d.pop();)e.shift().apply(e.shift()||window,e.shift()||[]);if(undefined===a){var f=this.table_;for(var g in f)this.digest(g,b)}},a.prototype.clear=function(a){switch(typeof a){case"string":!this.option_[a]&&this.define(a),this.table_[a].splice(0,this.table_[a].length);break;default:var b=this.table_;for(var c in b)this.clear(c)}},a}();a.Task=b}(b=a.LIBRARY||(a.LIBRARY={}))}(MODULE||(MODULE={}));var MODULE;!function(a){var b;!function(a){var b;!function(a){var b;!function(a){var b;!function(a){var b;!function(a){var b=function(){function a(a){this.task_=a,this.labels_={done:"done",fail:"fail",always:"always"}}return a.prototype.done=function(a){return this.task_.reserve(this.labels_.done,a),this},a.prototype.fail=function(a){return this.task_.reserve(this.labels_.fail,a),this},a.prototype.always=function(a){return this.task_.reserve(this.labels_.always,a),this},a.prototype.resolve=function(){return this.task_.clear(this.labels_.fail),this.task_.digest(this.labels_.done),this.task_.digest(this.labels_.always),this},a.prototype.reject=function(){return this.task_.clear(this.labels_.done),this.task_.digest(this.labels_.fail),this.task_.digest(this.labels_.always),this},a}();a.Task=b;var c=function(a){function b(){a.apply(this,arguments)}return __extends(b,a),b}(b);a.TaskUp=c;var d=function(a){function b(){a.apply(this,arguments)}return __extends(b,a),b.prototype.done=function(){return this},b.prototype.fail=function(){return this},b.prototype.always=function(){return this},b.prototype.resolve=function(){return this},b}(b);a.TaskDown=d}(b=a.STATEFUL||(a.STATEFUL={}))}(b=a.DB||(a.DB={}))}(b=a.DATA||(a.DATA={}))}(b=a.APP||(a.APP={}))}(b=a.MODEL||(a.MODEL={}))}(MODULE||(MODULE={}));var MODULE;!function(a){var b;!function(b){var c;!function(b){var c;!function(b){var c;!function(b){var c=function(){function c(b,c,d){var e=this;this.origin_=b,this.connect_=c,this.extend_=d,this.state_=function(){return e.origin_.state()},this.task_=new a.LIBRARY.Task,this.cache_={stateful:{}}}return c.prototype.stateful_=function(){var a=this,c=function(b,c){return a.cache_.stateful[a.state_()]=a.cache_.stateful[a.state_()]||new b(a.origin_,a.connect_,a.extend_,a.task_,c)};switch(this.state_()){case 0:return c(b.STATE.Blank,!0);case 1:return c(b.STATE.Initiate,!0);case 2:return c(b.STATE.Open,!0);case 9:return c(b.STATE.Close,!0);case 8:return c(b.STATE.Terminate,!0);case 6:return c(b.STATE.Error,!1);default:return c(b.STATE.Except,!1)}},c.prototype.open=function(){return this.stateful_().open()},c.prototype.resolve=function(){return this.stateful_().resolve()},c.prototype.reject=function(){return this.stateful_().reject()},c}();b.Stateful=c}(c=b.DB||(b.DB={}))}(c=b.DATA||(b.DATA={}))}(c=b.APP||(b.APP={}))}(b=a.MODEL||(a.MODEL={}))}(MODULE||(MODULE={}));var MODULE;!function(a){var b;!function(a){var b;!function(a){var b;!function(a){var b;!function(a){var b;!function(b){var c=function(){function b(b,c,d,e,f){this.origin=b,this.connect=c,this.extend=d,this.task=f?new a.STATEFUL.TaskUp(e):new a.STATEFUL.TaskDown(e)}return b.prototype.open=function(){return this.task},b.prototype.resolve=function(){},b.prototype.reject=function(){this.task.reject()},b}();b.Default=c;var d=function(a){function b(){a.apply(this,arguments)}return __extends(b,a),b.prototype.open=function(){return this.connect(),this.task},b.prototype.resolve=function(){this.open()},b.prototype.reject=function(){this.task.reject()},b}(c);b.Blank=d;var e=function(a){function b(){a.apply(this,arguments)}return __extends(b,a),b.prototype.open=function(){return this.task},b.prototype.resolve=function(){},b.prototype.reject=function(){this.task.reject()},b}(c);b.Initiate=e;var f=function(a){function b(){a.apply(this,arguments)}return __extends(b,a),b.prototype.open=function(){var a=this;return this.extend(),setTimeout(function(){return a.origin.resolve()},1),this.task},b.prototype.resolve=function(){this.task.resolve()},b.prototype.reject=function(){this.task.reject()},b}(c);b.Open=f;var g=function(a){function b(){a.apply(this,arguments)}return __extends(b,a),b.prototype.open=function(){return this.connect(),this.task},b.prototype.resolve=function(){this.open()},b.prototype.reject=function(){this.task.reject()},b}(c);b.Close=g;var h=function(a){function b(){a.apply(this,arguments)}return __extends(b,a),b}(c);b.Terminate=h;var i=function(a){function b(){a.apply(this,arguments)}return __extends(b,a),b}(c);b.Error=i;var j=function(a){function b(){a.apply(this,arguments)}return __extends(b,a),b}(c);b.Except=j}(b=a.STATE||(a.STATE={}))}(b=a.DB||(a.DB={}))}(b=a.DATA||(a.DATA={}))}(b=a.APP||(a.APP={}))}(b=a.MODEL||(a.MODEL={}))}(MODULE||(MODULE={}));var MODULE;!function(a){var b;!function(a){var b;!function(a){var b;!function(a){var b=function(){function a(a){this.DB=a,this.autoIncrement=!0,this.indexes=[],this.limit=0,this.buffer_=[]}return a.prototype.accessStore=function(a,b){var c=this;void 0===b&&(b="readwrite");try{var d=this.DB.database(),e=d&&d.transaction(this.name,b).objectStore(this.name)}catch(f){}e?a(e):this.DB.open().done(function(){return c.accessStore(a)})},a.prototype.accessCount=function(){var a="string"==typeof arguments[0]&&arguments[0],b=arguments[a?1:0];this.accessStore(function(c){var d=a?c.index(a).count():c.count();d.onsuccess=function(){b.apply(this,[].slice.call(arguments,1).concat(this.result))}})},a.prototype.accessRecord=function(a,b,c){this.accessStore(function(c){c.get(a).onsuccess=b},c)},a.prototype.accessCursor=function(a,b,c,d){this.accessStore(function(e){var f;f=c&&b?e.index(a).openCursor(b,c):b?e.index(a).openCursor(b):e.openCursor(),f.onsuccess=d})},a.prototype.accessAll=function(a,b,c,d){"function"==typeof a&&(d=a,a=null,b=null,c=null),this.accessCursor(a,b,c,d)},a.prototype.get=function(a,b){this.accessRecord(a,b)},a.prototype.set=function(a,b){if(!b)return this.put(a);a=jQuery.extend(!0,{},a);var c=a[this.keyPath];this.accessRecord(c,function(){this.source.put(jQuery.extend(!0,{},this.result,a))})},a.prototype.add=function(a){a=jQuery.extend(!0,{},a);a[this.keyPath];this.autoIncrement&&delete a[this.keyPath],this.accessStore(function(b){b.add(a)})},a.prototype.put=function(a){a=jQuery.extend(!0,{},a);a[this.keyPath];this.accessStore(function(b){b.put(a)})},a.prototype.remove=function(a){this.accessStore(function(b){b["delete"](a)})},a.prototype.clear=function(){this.accessStore(function(a){a.clear()})},a.prototype.clean=function(){var a=this;if(this.limit&&this.indexes.length){var b=this.indexes[0].name,c=this.limit;this.accessCount(b,function(d){c>=d||(c=d-c,a.accessCursor(b,a.DB.IDBKeyRange.upperBound(1/0),"prev",function(){if(this.result&&c--){var a=this.result;a["delete"](),a["continue"]()}}))})}},a.prototype.loadBuffer=function(a){function b(){if(this.result){var b=this.result;c[b.primaryKey]=b.value,--a&&b["continue"]()}}void 0===a&&(a=0);var c=this.buffer_;this.indexes.length?this.accessAll(this.indexes[0].name,this.DB.IDBKeyRange.upperBound(1/0),"prev",b):this.accessAll(b)},a.prototype.saveBuffer=function(){var a=this.buffer_;this.accessStore(function(b){for(var c in a)b.put(a[c])})},a.prototype.getBuffers=function(){return this.buffer_},a.prototype.setBuffers=function(a,b){for(var c in a)this.setBuffer(a[c],b);return this.buffer_},a.prototype.getBuffer=function(a){return this.buffer_[a]},a.prototype.setBuffer=function(a,b){var c=a[this.keyPath];return this.buffer_[c]=b?jQuery.extend(!0,{},this.buffer_[c],a):a,this.buffer_[c]},a.prototype.addBuffer=function(a){return a[this.keyPath]=this.buffer_.length||1,this.buffer_.push(a),a},a.prototype.removeBuffer=function(a){var b=this.buffer_[a];return"number"==typeof a&&a>=0&&a in this.buffer_&&this.buffer_.length>a?this.buffer_.splice(a,1):delete this.buffer_[a],b},a.prototype.clearBuffer=function(){this.buffer_.splice(0,this.buffer_.length)},a}();a.Store=b}(b=a.DATA||(a.DATA={}))}(b=a.APP||(a.APP={}))}(b=a.MODEL||(a.MODEL={}))}(MODULE||(MODULE={}));var MODULE;!function(a){var b;!function(a){var b;!function(a){var b;!function(a){var b;!function(b){var c=function(a){function b(){a.apply(this,arguments),this.name="meta",this.keyPath="key",this.autoIncrement=!1,this.limit=0}return __extends(b,a),b}(a.Store);b.Meta=c}(b=a.STORE||(a.STORE={}))}(b=a.DATA||(a.DATA={}))}(b=a.APP||(a.APP={}))}(b=a.MODEL||(a.MODEL={}))}(MODULE||(MODULE={}));var MODULE;!function(a){var b;!function(a){var b;!function(a){var b;!function(a){var b;!function(b){var c=function(a){function b(){a.apply(this,arguments),this.name="history",this.keyPath="url",this.autoIncrement=!1,this.indexes=[{name:"date",keyPath:"date",option:{unique:!1}}],this.limit=1e3}return __extends(b,a),b}(a.Store);b.History=c}(b=a.STORE||(a.STORE={}))}(b=a.DATA||(a.DATA={}))}(b=a.APP||(a.APP={}))}(b=a.MODEL||(a.MODEL={}))}(MODULE||(MODULE={}));var MODULE;!function(a){var b;!function(a){var b;!function(a){var b;!function(a){var b;!function(b){var c=function(a){function b(){a.apply(this,arguments),this.name="server",this.keyPath="host",this.autoIncrement=!1,this.indexes=[{name:"date",keyPath:"date",option:{unique:!1}}],this.limit=100}return __extends(b,a),b}(a.Store);b.Server=c}(b=a.STORE||(a.STORE={}))}(b=a.DATA||(a.DATA={}))}(b=a.APP||(a.APP={}))}(b=a.MODEL||(a.MODEL={}))}(MODULE||(MODULE={}));var MODULE;!function(a){var b;!function(b){var c;!function(b){var c;!function(b){var c=function(){function c(){var c=this;this.IDBFactory=window.indexedDB||window.webkitIndexedDB||window.mozIndexedDB||window.msIndexedDB,this.IDBKeyRange=window.IDBKeyRange||window.webkitIDBKeyRange||window.mozIDBKeyRange||window.msIDBKeyRange,this.name_=a.DEF.NAME,this.version_=8,this.refresh_=10,this.upgrade_=0,this.state_=0,this.age_=1e4,this.expires_=0,this.timer_=0,this.stateful_=new b.DB.Stateful(this,function(){return c.connect_()},function(){return c.extend_()}),this.stores={meta:new b.STORE.Meta(this),history:new b.STORE.History(this),server:new b.STORE.Server(this)},this.meta={version:{key:"version",value:undefined},update:{key:"update",value:undefined}}}return c.prototype.extend_=function(){var a=this;this.expires_=(new Date).getTime()+this.age_,clearTimeout(this.timer_),this.timer_=setTimeout(function(){return a.check_()},this.age_)},c.prototype.check_=function(){!this.age_||(new Date).getTime()<=this.expires_||2===this.state()&&this.close()},c.prototype.state=function(){return this.state_},c.prototype.database=function(){return this.extend_(),this.database_},c.prototype.up=function(){this.state_=0,this.open()},c.prototype.down=function(){this.reject(),this.close(),this.state_=6},c.prototype.open=function(){return!this.IDBFactory&&this.down(),this.stateful_.open()},c.prototype.close=function(){this.database_&&this.database_.close&&this.database_.close(),this.state_=9},c.prototype.resolve=function(){this.stateful_.resolve()},c.prototype.reject=function(){this.stateful_.reject()},c.prototype.connect_=function(){this.create_()},c.prototype.create_=function(){var a=this;try{this.close(),this.state_=1;var b=this.IDBFactory.open(this.name_,this.upgrade_?this.version_:1),c=function(){a.verify_(a.version_,function(){a.state_=2,a.resolve(),a.extend_()})};if("done"===b.readyState)this.database_=b.result,this.database()?c():this.format_();else{var d=setTimeout(function(){return a.down()},3e3);b.onblocked=function(){clearTimeout(d),a.database_=b.result,a.close(),setTimeout(function(){return a.open()},1e3)},b.onupgradeneeded=function(){clearTimeout(d),a.database_=b.result,a.createStores_()},b.onsuccess=function(){clearTimeout(d),a.database_=b.result,c()},b.onerror=function(){clearTimeout(d),a.database_=b.result,a.down()}}}catch(e){this.down()}},c.prototype.destroy_=function(a,b){var c=this;try{this.close(),this.state_=8;var d=this.IDBFactory.deleteDatabase(this.name_);d&&(d.onsuccess=a,d.onerror=b),setTimeout(function(){return 8===c.state()&&c.down()},3e3)}catch(e){this.down()}},c.prototype.format_=function(){var a=this;this.destroy_(function(){return a.up()},function(){return a.down()})},c.prototype.verify_=function(a,b){var c=this,d=this.database(),e=this.meta,f=this.stores.meta,g=function(){return c.format_()};if(d.objectStoreNames.length!==Object.keys(this.stores).length)return void g();for(var h in this.stores){var i=d.transaction(this.stores[h].name,"readonly").objectStore(this.stores[h].name);switch(!1){case i.keyPath===this.stores[h].keyPath:case i.indexNames.length===this.stores[h].indexes.length:return void g()}}var j=!1;f.get(e.version.key,function(b){if(!j){var d=b.target.result;!d||c.upgrade_?f.set(f.setBuffer({key:e.version.key,value:a})):d.value>a?(j=!0,c.down()):d.value<a&&(j=!0,g())}}),f.get(e.update.key,function(a){if(!j){var d=a.target.result,h=Math.floor((new Date).getTime()/864e5);d&&c.refresh_?d.value>h?b():d.value<=h&&g():(f.set(f.setBuffer({key:e.update.key,value:h+c.refresh_})),b())}})},c.prototype.createStores_=function(){this.destroyStores_();var a=this.database();for(var b in this.stores)for(var c,d=this.stores[b],e=a.createObjectStore(d.name,{keyPath:d.keyPath,autoIncrement:d.autoIncrement}),f=0,g=d.indexes;c=g[f];f++)e.createIndex(c.name,c.keyPath,c.option)},c.prototype.destroyStores_=function(){for(var a=this.database(),b=a.objectStoreNames?a.objectStoreNames.length:0;b--;)a.deleteObjectStore(a.objectStoreNames[b])},c}();b.Database=c}(c=b.DATA||(b.DATA={}))}(c=b.APP||(b.APP={}))}(b=a.MODEL||(a.MODEL={}))}(MODULE||(MODULE={}));var MODULE;!function(a){var b;!function(a){var b;!function(a){var b;!function(a){var b=function(){function a(a){this.age_=a}return a.prototype.getCookie=function(a){if(a&&window.navigator.cookieEnabled){var b=new RegExp("(?:^|; )("+encodeURIComponent(a)+"=[^;]*)"),c=(document.cookie.match(b)||[]).pop();return c&&decodeURIComponent(c.split("=").pop())}},a.prototype.setCookie=function(a,b,c){return void 0===c&&(c={}),a&&window.navigator.cookieEnabled?(c.age=c.age||this.age_,document.cookie=[encodeURIComponent(a)+"="+encodeURIComponent(b),c.age?"; expires="+new Date((new Date).getTime()+1e3*c.age).toUTCString():"",c.path?"; path="+c.path:"; path=/",c.secure?"; secure":""].join(""),this.getCookie(a)):void 0},a}();a.Cookie=b}(b=a.DATA||(a.DATA={}))}(b=a.APP||(a.APP={}))}(b=a.MODEL||(a.MODEL={}))}(MODULE||(MODULE={}));var MODULE;!function(a){var b;!function(a){var b;!function(a){var b;!function(a){var b=function(){function b(){this.DB=new a.Database,this.Cookie=new a.Cookie(864e3)}return b}();a.Main=b}(b=a.DATA||(a.DATA={}))}(b=a.APP||(a.APP={}))}(b=a.MODEL||(a.MODEL={}))}(MODULE||(MODULE={}));var MODULE;!function(a){var b;!function(a){var b=function(){function a(){}return a.trim=function(a){if(a="string"==typeof a?a:String(0===a&&a.toString()||""),a.trim)a=a.trim();else if(a=a.replace(/^[\s\uFEFF\xA0]+/,"")){var b=/[\s\uFEFF\xA0]/,c=a.length,d=c%8;a:{for(;d--;)if(!b.test(a.charAt(--c)))break a;for(;c;){if(!b.test(a.charAt(--c)))break a;if(!b.test(a.charAt(--c)))break a;if(!b.test(a.charAt(--c)))break a;if(!b.test(a.charAt(--c)))break a;if(!b.test(a.charAt(--c)))break a;if(!b.test(a.charAt(--c)))break a;if(!b.test(a.charAt(--c)))break a;if(!b.test(a.charAt(--c)))break a}}a=a.substring(0,c+1)}return a},a.repeat=function(a,b){switch(a instanceof Array&&"array"||typeof a){case"string":var c=a;return Array(b+1).join(c);case"array":var d=a.length;if(300>b){var e=Array(b);this.duff(-b,function(b){return e[b]=a[b%d]})}else{for(var e=a.slice();2*e.length<=b;)e=e.concat(e);e=e.concat(e.slice(0,b-e.length))}return e}},a.fire=function(a,b,c,d){return void 0===b&&(b=window),void 0===c&&(c=[]),"function"==typeof a?d?setTimeout(function(){a.apply(b||window,c)},0):a.apply(b||window,c):a},a.duff=function(a,b){if(0>a){for(var c=-a,d=c%8;d--;)b(--c);for(;c;)b(--c),b(--c),b(--c),b(--c),b(--c),b(--c),b(--c),b(--c)}else{for(var e=a,c=0,d=e%8,f=e/8^0;d--;)b(c++);for(;f--;)b(c++),b(c++),b(c++),b(c++),b(c++),b(c++),b(c++),b(c++)}},a.duffEx=function(a,b){if(0>a){var c=-a,d=c%8;a:{for(;d--;)if(!1===b(--c))break a;for(;c;){if(!1===b(--c))break a;if(!1===b(--c))break a;if(!1===b(--c))break a;if(!1===b(--c))break a;if(!1===b(--c))break a;if(!1===b(--c))break a;if(!1===b(--c))break a;if(!1===b(--c))break a}}}else{var e=a,c=0,d=e%8,f=e/8^0;a:{for(;d--;)if(!1===b(c++))break a;for(;f--;){if(!1===b(c++))break a;if(!1===b(c++))break a;if(!1===b(c++))break a;if(!1===b(c++))break a;if(!1===b(c++))break a;if(!1===b(c++))break a;if(!1===b(c++))break a;if(!1===b(c++))break a}}}},a.normalizeUrl=function(a,b){void 0===b&&(b=!0);var c;return c=this.trim(a),c=/^([^:/?#]+):\/\/[^/?#.]+\.[^/?#]+/i.test(c)?c:function(a,b){return b.href=a,b.href}(c,document.createElement("a")),c=encodeURI(decodeURI(c)),c=c.replace(/["`^|\\<>{}\[\]\s].*/,""),c=b?this.justifyPercentEncodingUrlCase_(a,c):c},a.canonicalizeUrl=function(a){function b(a){return a.toUpperCase()}var c=this.normalizeUrl(a,!1);return c=c.replace(/(?:%\w{2})+/g,b)},a.compareUrl=function(a,b,c){return c&&(a=this.canonicalizeUrl(a),b=this.canonicalizeUrl(b)),a===this.justifyPercentEncodingUrlCase_(a,b)},a.justifyPercentEncodingUrlCase_=function(a,b){function c(b){var c=~a.indexOf(b.toUpperCase())||~a.indexOf(b.toLowerCase());return c?a.substr(~c,b.length):b}return a===b?b:b.replace(/(?:%\w{2})+/g,c)},a}();a.Utility=b}(b=a.LIBRARY||(a.LIBRARY={}))}(MODULE||(MODULE={}));var MODULE;!function(a){var b;!function(b){var c;!function(b){var c=function(){function c(c,d){this.model_=c,this.app_=d,this.data_=new b.DATA.Main,this.stores_=this.data_.DB.stores,this.util_=a.LIBRARY.Utility}return c.prototype.getCookie=function(a){return this.data_.Cookie.getCookie(a)},c.prototype.setCookie=function(a,b,c){return this.data_.Cookie.setCookie(a,b,c)},c.prototype.connect=function(a){a.database&&(this.data_.DB.up(),this.saveTitle(),this.saveScrollPosition())},c.prototype.loadBuffers=function(a){void 0===a&&(a=0);for(var b in this.stores_)this.stores_[b].loadBuffer(a)},c.prototype.saveBuffers=function(){for(var a in this.stores_)this.stores_[a].saveBuffer()},c.prototype.getHistoryBuffer=function(a){return this.stores_.history.getBuffer(this.model_.convertUrlToKeyUrl(this.util_.normalizeUrl(a)))},c.prototype.loadTitle=function(){var a=this,b=this.model_.convertUrlToKeyUrl(this.util_.normalizeUrl(window.location.href)),c=this.stores_.history.getBuffer(b);c&&"string"==typeof c.title?document.title=c.title:this.stores_.history.get(b,function(d){c=d.target.result,c&&c.title&&a.util_.compareUrl(b,a.model_.convertUrlToKeyUrl(a.util_.normalizeUrl(window.location.href)))&&(document.title=c.title)})},c.prototype.saveTitle=function(a,b){void 0===a&&(a=window.location.href),void 0===b&&(b=document.title);var c=this.model_.convertUrlToKeyUrl(this.util_.normalizeUrl(a)),d={url:c,title:b,date:(new Date).getTime(),scrollX:undefined,scrollY:undefined,host:undefined,expires:undefined};this.stores_.history.setBuffer(d,!0),this.stores_.history.set(d,!0),this.stores_.history.clean()},c.prototype.loadScrollPosition=function(){function a(a,b){"number"==typeof a&&"number"==typeof b&&window.scrollTo(parseInt(Number(a)+"",10),parseInt(Number(b)+"",10))}var b=this,c=this.model_.convertUrlToKeyUrl(this.util_.normalizeUrl(window.location.href)),d=this.stores_.history.getBuffer(c);d&&"number"==typeof d.scrollX?a(d.scrollX,d.scrollY):this.stores_.history.get(c,function(e){d=e.target.result,d&&"number"==typeof d.scrollX&&b.util_.compareUrl(c,b.model_.convertUrlToKeyUrl(b.util_.normalizeUrl(window.location.href)))&&a(d.scrollX,d.scrollY)})},c.prototype.saveScrollPosition=function(a,b,c){void 0===a&&(a=window.location.href),void 0===b&&(b=jQuery(window).scrollLeft()),void 0===c&&(c=jQuery(window).scrollTop());var d=this.model_.convertUrlToKeyUrl(this.util_.normalizeUrl(a)),e={url:d,scrollX:b,scrollY:c,date:(new Date).getTime(),title:undefined,host:undefined,expires:undefined};this.stores_.history.setBuffer(e,!0),this.stores_.history.set(e,!0)},c.prototype.loadExpires=function(){},c.prototype.saveExpires=function(a,b,c){var d=this.model_.convertUrlToKeyUrl(this.util_.normalizeUrl(a)),e={url:d,host:b||"",expires:c,title:undefined,scrollX:undefined,scrollY:undefined,date:undefined};this.stores_.history.setBuffer(e,!0),this.stores_.history.set(e,!0)},c.prototype.getServerBuffers=function(){return this.stores_.server.getBuffers()},c.prototype.loadServer=function(){},c.prototype.saveServer=function(a,b,c){void 0===c&&(c=0);var d=this.stores_.server,e={host:a.split("//").pop().split("/").shift()||"",score:b,state:c,date:(new Date).getTime()};d.setBuffer(e,!0),d.get(a,function(){var b=this.result;b&&c?b.state&&d["delete"](a):d.set(e)}),this.stores_.server.clean()},c}();b.Data=c}(c=b.APP||(b.APP={}))}(b=a.MODEL||(a.MODEL={}))}(MODULE||(MODULE={}));var MODULE;!function(a){var b;!function(b){var c;!function(b){var c=function(){function b(b,c){var d=this;this.model_=b,this.app_=c,this.util_=a.LIBRARY.Utility,this.host_="",this.host=function(){return d.host_},this.parallel_=6,this.queue_=[]}return b.prototype.isBalanceable_=function(a){return a.balance.self&&!!Number(this.app_.data.getCookie(a.balance.client.cookie.balance))},b.prototype.enable=function(a){return this.isBalanceable_(a)?!a.balance.client.support.userAgent.test(window.navigator.userAgent)||a.balance.client.exclude.test(window.navigator.userAgent)?void this.disable(a):this.app_.data.setCookie(a.balance.client.cookie.balance,"1")?void(a.balance.client.support.redirect.test(window.navigator.userAgent)&&this.app_.data.setCookie(a.balance.client.cookie.redirect,"1")):void this.disable(a):void this.disable(a)},b.prototype.disable=function(a){this.app_.data.getCookie(a.balance.client.cookie.balance)&&this.app_.data.setCookie(a.balance.client.cookie.balance,"0"),this.app_.data.getCookie(a.balance.client.cookie.redirect)&&this.app_.data.setCookie(a.balance.client.cookie.redirect,"0"),this.changeServer("",a)
},b.prototype.changeServer=function(a,b){return void 0===b&&(b=this.model_.configure(window.location)),a=b&&this.isBalanceable_(b)?a||"":"",this.host_=a,this.app_.data.setCookie(b.balance.client.cookie.host,a),this.host()},b.prototype.chooseServers_=function(a,b,c,d){var e,f=this.app_.data.getServerBuffers(),g={};!function(){var b=(new Date).getTime();for(var c in f)b>f[c].date+a||(g[f[c].score]=f[c])}(),e=[];for(var h,i=Object.keys(g).sort(),j=0;h=e.length<b&&i[j];j++){var k=g[h],l=k.host,m=k.state;m&&m+d>=(new Date).getTime()||(l||!c||Math.floor(Math.random())*c)&&e.push(l)}return e},b.prototype.chooseServer=function(a){if(!this.isBalanceable_(a))return"";var b=this.app_.data.getHistoryBuffer(a.destLocation.href);if(b&&b.expires&&b.expires>=(new Date).getTime())return b.host||"";if(!this.app_.data.getServerBuffers().length&&!this.app_.data.getCookie(a.balance.client.cookie.host))return"";var c=this.chooseServers_(a.balance.history.expires,1,a.balance.weight,a.balance.server.respite);return c.length?c.shift():""},b.prototype.bypass=function(a,b){var c=this;if(this.isBalanceable_(a)){this.queue_=this.queue_.length?this.queue_:this.chooseServers_(a.balance.history.expires,a.balance.history.limit,a.balance.weight,a.balance.server.respite).slice(0,b+1);for(var d=this.queue_,e=jQuery.extend({},a.ajax,a.balance.option.ajax,a.balance.option.callbacks.ajax);d.length&&this.host();){if(!this.parallel_)return void(d.length&&setTimeout(function(){return c.bypass(a,d.length-1)},e.timeout||1500));!function(b){--c.parallel_;var f=c;jQuery.ajax(jQuery.extend({},e,{url:f.util_.normalizeUrl(b+window.location.pathname.replace(/^\/?/,"/")+window.location.search),xhr:a.balance.option.callbacks.ajax.xhr?function(){var b;return b=f.util_.fire(a.balance.option.callbacks.ajax.xhr,this,[event,a]),b="object"==typeof b?b:jQuery.ajaxSettings.xhr()}:undefined,beforeSend:a.balance.option.callbacks.ajax.beforeSend||a.server.header?function(b,c){a.server.header&&b.setRequestHeader(a.nss.requestHeader,"true"),"object"==typeof a.server.header&&(b.setRequestHeader(a.nss.requestHeader,"true"),a.server.header.area&&b.setRequestHeader(a.nss.requestHeader+"-Area",this.app_.chooseArea(a.area,document,document)),a.server.header.head&&b.setRequestHeader(a.nss.requestHeader+"-Head",a.load.head),a.server.header.css&&b.setRequestHeader(a.nss.requestHeader+"-CSS",a.load.css.toString()),a.server.header.script&&b.setRequestHeader(a.nss.requestHeader+"-Script",a.load.script.toString())),f.util_.fire(a.balance.option.callbacks.ajax.beforeSend,this,[event,a,b,c])}:undefined,dataFilter:a.balance.option.callbacks.ajax.dataFilter?function(b,c){return f.util_.fire(a.balance.option.callbacks.ajax.dataFilter,this,[event,a,b,c])||b}:undefined,success:function(){f.host_=b,f.queue_=[],f.util_.fire(a.balance.option.ajax.success,this,arguments)},error:function(){f.util_.fire(a.balance.option.ajax.error,this,arguments)},complete:function(){++f.parallel_,d.length&&f.bypass(a,d.length-1),f.util_.fire(a.balance.option.ajax.complete,this,arguments)}}))}(d.shift())}}},b}();b.Balance=c}(c=b.APP||(b.APP={}))}(b=a.MODEL||(a.MODEL={}))}(MODULE||(MODULE={}));var MODULE;!function(a){var b;!function(a){var b;!function(a){var b=function(){function a(a,b,d,e,f,g){this.model_=a,this.data_=b?{url:this.model_.convertUrlToKeyUrl(b.destLocation.href),data:d,textStatus:e,jqXHR:f,host:g}:{url:undefined,data:undefined,textStatus:undefined,jqXHR:undefined,host:undefined},this.data=new c(this.data_)}return a.prototype.state=function(){switch(!1){case this.data.jqXHR()&&200===+this.data.jqXHR().status:case this.data.expires()>=(new Date).getTime():return!1;default:return!0}},a}();a.PageRecord=b;var c=function(){function a(a){this.data_=a}return a.prototype.url=function(){return this.data_.url},a.prototype.data=function(){return this.data_.data},a.prototype.textStatus=function(){return this.data_.textStatus},a.prototype.jqXHR=function(){return this.data_.jqXHR},a.prototype.host=function(){return this.data_.host},a.prototype.expires=function(a,b){var c,d=this.jqXHR();switch(!0){case!d:c=0;break;case/no-store|no-cache/.test(d.getResponseHeader("Cache-Control")):c=0;break;case!!d.getResponseHeader("Cache-Control")&&!!~d.getResponseHeader("Cache-Control").indexOf("max-age="):c=new Date(d.getResponseHeader("Date")).getTime()+1e3*+d.getResponseHeader("Cache-Control").match(/max-age=(\d*)/).pop();break;case!!d.getResponseHeader("Expires"):c=new Date(d.getResponseHeader("Expires")).getTime();break;default:c=0}return(undefined!==a||undefined!==b)&&(c="number"==typeof a?Math.max(a+(new Date).getTime(),c):c,c="number"==typeof b?Math.min(b+(new Date).getTime(),c):c),c=Math.max(c,0)||0},a}();a.PageRecordData=c}(b=a.APP||(a.APP={}))}(b=a.MODEL||(a.MODEL={}))}(MODULE||(MODULE={}));var MODULE;!function(a){var b;!function(a){var b;!function(a){var b=function(){function a(){}return a.prototype.chooseArea=function(a,b,c){a=a instanceof Array?a:[a];var d,e=-1;a:for(;d=a[++e];){for(var f=d.match(/(?:[^,\(\[]+|\(.*?\)|\[.*?\])+/g),g=-1;f[++g];)if(!jQuery(f[g],b).length||!jQuery(f[g],c).length)continue a;return d}},a.prototype.dispatchEvent=function(a,b,c,d){var e=document.createEvent("HTMLEvents");e.initEvent(b,c,d),a.dispatchEvent(e)},a}();a.PageUtility=b}(b=a.APP||(a.APP={}))}(b=a.MODEL||(a.MODEL={}))}(MODULE||(MODULE={}));var MODULE;!function(a){var b;!function(b){var c;!function(b){var c=function(){function b(b,c,d,e,f,g){this.model_=b,this.app_=c,this.setting_=d,this.event_=e,this.success=f,this.failure=g,this.util_=a.LIBRARY.Utility,this.main_()}return b.prototype.main_=function(){function b(){return h.model_.isDeferrable?undefined:e.call(this,[].slice.call(arguments),undefined)}function c(){return h.model_.isDeferrable?undefined:f.apply(this,arguments)}function d(){return h.model_.isDeferrable?undefined:g.apply(this,arguments)}function e(a){arguments.length&&arguments[0]&&(h.data_=a[0],h.textStatus_=a[1],h.jqXHR_=a[2],h.util_.fire(i.callbacks.ajax.success,this,[j,i,h.data_,h.textStatus_,h.jqXHR_]))}function f(a,b,c){arguments.length&&arguments[0]&&(h.jqXHR_=a,h.textStatus_=b,h.errorThrown_=c,h.util_.fire(i.callbacks.ajax.error,this,[j,i,h.jqXHR_,h.textStatus_,h.errorThrown_]))}function g(){arguments.length&&arguments[0]&&(h.util_.fire(i.callbacks.ajax.complete,this,[j,i,h.jqXHR_,h.textStatus_]),h.model_.setXHR(null),200===+h.jqXHR_.status?(h.model_.setCache(i.destLocation.href,n&&n.data||null,h.textStatus_,h.jqXHR_),h.success(i,j,h.data_,h.textStatus_,h.jqXHR_,h.host_)):h.failure(i,j,h.data_,h.textStatus_,h.jqXHR_,h.host_))}var h=this,i=this.setting_,j=this.event_=jQuery.extend(!0,{},this.event_),k=this.util_.fire(i.wait,i,[j,i,i.origLocation.cloneNode(),i.destLocation.cloneNode()]),l=i.speedcheck,m=this.model_.speed;l&&(m.fire=j.timeStamp),l&&m.time.splice(0,100,0),l&&m.name.splice(0,100,"pjax("+m.time.slice(-1)+")");var n;switch(i.cache[j.type.toLowerCase()]&&j.type.toLowerCase()){case a.EVENT.CLICK:n=this.model_.getCache(i.destLocation.href);break;case a.EVENT.SUBMIT:n=i.cache[j.currentTarget.method.toLowerCase()]?this.model_.getCache(i.destLocation.href):n;break;case a.EVENT.POPSTATE:n=this.model_.getCache(i.destLocation.href)}this.dispatchEvent(document,a.DEF.NAME+":fetch",!1,!1);var o=this.model_.getXHR();if(n&&n.jqXHR&&200===+n.jqXHR.status)if(l&&m.name.splice(0,1,"cache("+m.time.slice(-1)+")"),this.app_.loadtime=0,this.model_.setXHR(null),this.host_=n.jqXHR.host||"",this.data_=n.jqXHR.responseText,this.textStatus_=n.textStatus,this.jqXHR_=n.jqXHR,this.model_.isDeferrable){var p=this.wait_(k);this.app_.page.setWait(p),jQuery.when(jQuery.Deferred().resolve(this.data_,this.textStatus_,this.jqXHR_),p).done(e).fail(f).always(g)}else{var q=jQuery.extend({},jQuery.ajaxSettings,i.ajax);q=q.context||q,b.call(q,this.data_,this.textStatus_,this.jqXHR_),d.call(q,this.jqXHR_,this.textStatus_)}else if(o&&o.follow&&!~"error abort timeout parsererror".indexOf(o.statusText)){l&&m.time.splice(0,1,o.timeStamp-m.fire),l&&m.name.splice(0,1,"preload("+m.time.slice(-1)+")"),l&&m.time.push(m.now()-m.fire),l&&m.name.push("continue("+m.time.slice(-1)+")"),this.host_=o.host||"",this.app_.loadtime=o.timeStamp;var p=this.wait_(k);this.app_.page.setWait(p),jQuery.when(o,p).done(e).fail(f).always(g)}else{this.app_.loadtime=j.timeStamp;var r=i.destLocation.cloneNode(),s={},t={};switch(this.app_.balance.changeServer(this.app_.balance.chooseServer(i),i),this.host_=i.balance.self&&this.model_.host().split("//").pop()||"",r.host=this.host_||i.destLocation.host,s.url=i.server.query?[r.protocol,"//",r.host,r.pathname.replace(/^\/?/,"/"),r.search.replace(/&*$/,"&"+i.server.query).replace(/^\??&/,"?").replace(/(\?|&)$/,""),r.hash].join(""):r.href,j.type.toLowerCase()){case a.EVENT.CLICK:s.type="GET";break;case a.EVENT.SUBMIT:switch(s.type=j.currentTarget.method.toUpperCase(),s.type){case"POST":jQuery(j.currentTarget).has(":file").length?"function"==typeof FormData&&(s.data=(new FormData)(j.currentTarget),s.contentType=!1,s.processData=!1):s.data=jQuery(j.currentTarget).serializeArray();break;case"GET":}break;case a.EVENT.POPSTATE:s.type="GET"}if(t={xhr:i.callbacks.ajax.xhr?function(){var a;return a=h.util_.fire(i.callbacks.ajax.xhr,this,[j,i]),a="object"==typeof a?a:jQuery.ajaxSettings.xhr()}:undefined,beforeSend:i.callbacks.ajax.beforeSend||i.server.header?function(a,b){i.server.header&&a.setRequestHeader(i.nss.requestHeader,"true"),"object"==typeof i.server.header&&(a.setRequestHeader(i.nss.requestHeader,"true"),i.server.header.area&&a.setRequestHeader(i.nss.requestHeader+"-Area",this.app_.chooseArea(i.area,document,document)),i.server.header.head&&a.setRequestHeader(i.nss.requestHeader+"-Head",i.load.head),i.server.header.css&&a.setRequestHeader(i.nss.requestHeader+"-CSS",i.load.css.toString()),i.server.header.script&&a.setRequestHeader(i.nss.requestHeader+"-Script",i.load.script.toString())),h.util_.fire(i.callbacks.ajax.beforeSend,this,[j,i,a,b])}:undefined,dataFilter:i.callbacks.ajax.dataFilter?function(a,b){return h.util_.fire(i.callbacks.ajax.dataFilter,this,[j,i,a,b])||a}:undefined,success:b,error:c,complete:d},s=jQuery.extend({},i.ajax,t,s),this.model_.setXHR(jQuery.ajax(s)),!this.model_.isDeferrable)return;var p=this.wait_(k);this.app_.page.setWait(p),jQuery.when(this.model_.getXHR(),p).done(e).fail(f).always(g)}},b.prototype.wait_=function(a){var b=jQuery.Deferred();return a?(setTimeout(function(){b.resolve()},a),b):b.resolve()},b.prototype.chooseArea=function(){},b.prototype.dispatchEvent=function(){},b}();b.PageFetch=c}(c=b.APP||(b.APP={}))}(b=a.MODEL||(a.MODEL={}))}(MODULE||(MODULE={}));var MODULE;!function(a){var b;!function(a){var b;!function(a){var b=function(){function b(a,b,c){var d=this;this.Record_=a,this.model_=b,this.app_=c,this.hash_=function(a){return d.model_.convertUrlToKeyUrl(a.destLocation.href)},this.table_={},this.order_=[]}return b.prototype.fetchRecord=function(a,b,c,d){this.getRecord(a).state()?this.pullRecord(a,b,c,d):this.pullRecord(a,b,c,d)},b.prototype.pullRecord=function(b,c,d,e){var f=this;new a.PageFetch(this.model_,this.app_,b,c,function(a){return function(b,c,d,e,g,h){var i=f.setRecord(b,f.getRecord(b).data.data()||"",e,g,h);a(i,b,c)}}(d),function(a){return function(b,c,d,e,g,h){var i=f.setRecord(b,f.getRecord(b).data.data()||"",e,g,h);a(i,b,c)}}(e))},b.prototype.getRecord=function(a){return this.table_[this.hash_(a)]=this.table_[this.hash_(a)]||new this.Record_},b.prototype.setRecord=function(a,b,c,d,e){return this.cleanRecords_(a),this.addOrder_(a),this.table_[this.hash_(a)]=new this.Record_(this.model_,a,b,c,d,e)},b.prototype.removeRecord=function(a){return this.removeOrder_(a),this.table_[this.hash_(a)]=new this.Record_},b.prototype.clearRecord=function(){this.order_=[],this.table_={}},b.prototype.cleanRecords_=function(a){if(a.cache.limit)for(;this.order_.length>=a.cache.limit;)this.removeRecord(this.app_.configure(this.order_.pop()))},b.prototype.addOrder_=function(a){this.removeOrder_(a),this.order_.unshift(this.hash_(a))},b.prototype.removeOrder_=function(a){for(var b,c=0,d=this.hash_(a);b=this.order_[c];c++)d===b&&this.order_.splice(c,1)},b}();a.PageProvider=b}(b=a.APP||(a.APP={}))}(b=a.MODEL||(a.MODEL={}))}(MODULE||(MODULE={}));var MODULE;!function(a){var b;!function(b){var c;!function(b){var c=function(){function b(b,c,d,e,f){this.model_=b,this.app_=c,this.setting_=d,this.event_=e,this.record_=f,this.util_=a.LIBRARY.Utility,this.loadwaits_=[],this.main_()}return b.prototype.main_=function(){var b=this.app_,c=this.record_,d=this.setting_,e=this.event_,f=(c.data.jqXHR().responseText,c.data.textStatus(),c.data.jqXHR()),g=(d.callbacks.update,d.speedcheck),h=this.model_.speed;if(g&&h.time.push(h.now()-h.fire),g&&h.name.push("fetch("+h.time.slice(-1)+")"),++this.app_.count,this.app_.loadtime=this.app_.loadtime&&(new Date).getTime()-this.app_.loadtime,d.cache.mix&&a.EVENT.POPSTATE!==e.type.toLowerCase()&&(new Date).getTime()-e.timeStamp<=d.cache.mix)return this.model_.fallback(e);try{if(b.page.landing=null,!~(f.getResponseHeader("Content-Type")||"").toLowerCase().search(d.contentType))throw new Error("throw: content-type mismatch");if(this.srcDocument_=this.app_.page.parser.parse(f.responseText,d.destLocation.href),this.dstDocument_=document,this.area_=this.chooseArea(d.area,this.srcDocument_,this.dstDocument_),!this.area_)throw new Error("throw: area notfound");if(this.areas_=this.area_.match(/(?:[^,]+?|\(.*?\)|\[.*?\])+/g),g&&h.time.push(h.now()-h.fire),g&&h.name.push("parse("+h.time.slice(-1)+")"),this.redirect_(),this.dispatchEvent(window,a.DEF.NAME+":unload",!1,!1),this.url_(),!this.util_.compareUrl(d.destLocation.href,this.util_.normalizeUrl(window.location.href)))throw new Error("throw: location mismatch");this.document_()}catch(i){if(!i)return;this.model_.getCache(window.location.href)&&this.model_.removeCache(d.destLocation.href),this.model_.fallback(e)}},b.prototype.isRegister_=function(b,c){switch(!0){case b.destLocation.href===b.origLocation.href:case a.EVENT.POPSTATE===c.type.toLowerCase():return!1;default:return!0}},b.prototype.isCacheUsable_=function(b,c){switch(!0){case!c.cache.click&&!c.cache.submit&&!c.cache.popstate:case a.EVENT.SUBMIT===b.type.toLowerCase()&&!c.cache[b.currentTarget.method.toLowerCase()]:return!1;default:return!0}},b.prototype.redirect_=function(){var b=this,c=this.setting_,d=this.event_,e=c.callbacks.update,f=(jQuery('head meta[http-equiv="Refresh"][content*="URL="]').attr("content")||"").match(/\w+:\/\/[^;\s"']+|$/i).shift();if(f){var g=c.destLocation.cloneNode();if(g.href=f,this.util_.fire(e.redirect.before,c,[d,c,g.cloneNode(),c.origLocation.cloneNode(),c.destLocation.cloneNode()])!==!1){switch(!0){case!c.redirect:case g.protocol!==c.destLocation.protocol:case g.host!==c.destLocation.host:case a.EVENT.SUBMIT===d.type.toLowerCase()&&"GET"!==d.currentTarget.method.toUpperCase():switch(d.type.toLowerCase()){case a.EVENT.CLICK:case a.EVENT.SUBMIT:window.location.assign(g.href);break;case a.EVENT.POPSTATE:window.location.replace(g.href)}throw!1;default:switch(jQuery[a.DEF.NAME].enable(),d.type.toLowerCase()){case a.EVENT.CLICK:case a.EVENT.SUBMIT:setTimeout(function(){return jQuery[a.DEF.NAME].click(g.href)},0);break;case a.EVENT.POPSTATE:window.history.replaceState(window.history.state,this.srcDocument_.title,g.href),this.isRegister_(c,d)&&c.fix.location&&!this.util_.compareUrl(c.destLocation.href,this.util_.normalizeUrl(window.location.href))&&(jQuery[a.DEF.NAME].disable(),window.history.back(),window.history.forward(),jQuery[a.DEF.NAME].enable()),setTimeout(function(){return b.dispatchEvent(window,a.EVENT.POPSTATE,!1,!1)},0)}throw!1}this.util_.fire(e.redirect.after,c,[d,c,g.cloneNode(),c.origLocation.cloneNode(),c.destLocation.cloneNode()])===!1}}},b.prototype.url_=function(){var b=this.setting_,c=this.event_,d=b.callbacks.update;this.model_.location.href=b.destLocation.href,this.util_.fire(d.url.before,b,[c,b,b.origLocation.cloneNode(),b.destLocation.cloneNode()])!==!1&&(this.isRegister_(b,c)&&(window.history.pushState(this.util_.fire(b.state,b,[c,b,b.origLocation.cloneNode(),b.destLocation.cloneNode()]),~window.navigator.userAgent.toLowerCase().indexOf("opera")?this.dstDocument_.title:this.srcDocument_.title,b.destLocation.href),b.fix.location&&!this.util_.compareUrl(b.destLocation.href,this.util_.normalizeUrl(window.location.href))&&(jQuery[a.DEF.NAME].disable(),window.history.back(),window.history.forward(),jQuery[a.DEF.NAME].enable())),this.util_.fire(d.url.after,b,[c,b,b.origLocation.cloneNode(),b.destLocation.cloneNode()])===!1)},b.prototype.document_=function(){var b=this,c=this.setting_,d=this.event_;this.overwriteDocumentByCache_(),c.fix.noscript&&this.escapeNoscript_(this.srcDocument_),this.rewrite_(),this.title_(),c.fix.history&&this.app_.data.saveTitle(),this.app_.data.saveExpires(this.record_.data.url(),this.record_.data.host(),this.record_.data.expires()),this.head_();var e=c.speedcheck,f=this.model_.speed;e&&f.time.push(f.now()-f.fire),e&&f.name.push("head("+f.time.slice(-1)+")"),this.content_(),e&&f.time.push(f.now()-f.fire),e&&f.name.push("content("+f.time.slice(-1)+")"),this.balance_(),this.css_('link[rel~="stylesheet"], style'),jQuery(window).one(a.DEF.NAME+":rendering",function(g){g.preventDefault(),g.stopImmediatePropagation();var h=function(e){return b.util_.compareUrl(b.model_.convertUrlToKeyUrl(c.destLocation.href),b.model_.convertUrlToKeyUrl(window.location.href),!0)?(b.dispatchEvent(document,a.DEF.NAME+":ready",!1,!1),b.util_.fire(c.callback,c,[d,c]),b.waitRender_(jQuery.when?jQuery.Deferred().resolve:e)):void 0},i=function(g){return b.util_.compareUrl(b.model_.convertUrlToKeyUrl(c.destLocation.href),b.model_.convertUrlToKeyUrl(window.location.href),!0)?(setTimeout(function(){switch(d.type.toLowerCase()){case a.EVENT.CLICK:case a.EVENT.SUBMIT:b.scrollByHash_(c.destLocation.hash)||b.scroll_(!0);break;case a.EVENT.POPSTATE:b.scroll_(!0)}},100),b.dispatchEvent(document,a.DEF.NAME+":render",!1,!1),e&&f.time.push(f.now()-f.fire),e&&f.name.push("render("+f.time.slice(-1)+")"),jQuery.when?jQuery.when.apply(jQuery,b.loadwaits_):g()):void 0},j=function(){return b.util_.compareUrl(b.model_.convertUrlToKeyUrl(c.destLocation.href),b.model_.convertUrlToKeyUrl(window.location.href),!0)?(b.dispatchEvent(window,a.DEF.NAME+":load",!1,!1),e&&f.time.push(f.now()-f.fire),e&&f.name.push("load("+f.time.slice(-1)+")"),e&&console.log(f.time),e&&console.log(f.name),b.script_("[src][defer]"),jQuery.when&&jQuery.Deferred().resolve()):jQuery.when&&jQuery.Deferred().reject()};if(b.scroll_(!1),100>b.app_.loadtime&&c.reset.type.match(d.type.toLowerCase())&&!jQuery('form[method][method!="GET"]').length)switch(!1){case b.app_.count<c.reset.count||!c.reset.count:case(new Date).getTime()<c.reset.time+b.app_.time||!c.reset.time:throw new Error("throw: reset")}var k=b.script_(":not([defer]), :not([src])");if(jQuery.when){var l=jQuery.Deferred().pipe?"pipe":"then";jQuery.when.apply(jQuery,k)[l](function(){return h()})[l](function(){return i()})[l](function(){return j()})}else h(function(){return i(function(){return j()})})}).trigger(a.DEF.NAME+":rendering")},b.prototype.overwriteDocumentByCache_=function(){var a=this.setting_,b=this.event_,c=this.model_.getCache(a.destLocation.href);if(this.isCacheUsable_(b,a)&&c&&c.data){var d=a.fix.noscript?this.restoreNoscript_(c.data):c.data,e=this.app_.page.parser.parse(d,a.destLocation.href),f=this.srcDocument_;f.title=e.title;for(var g,h,i=0;this.areas_[i];i++){if(g=jQuery(this.areas_[i],e).clone(),h=jQuery(this.areas_[i],f),!g.length||!h.length||g.length!==h.length)throw new Error("throw: area mismatch");for(var j=0;g[j];j++)h[j].parentNode.replaceChild(g[j],h[j])}}},b.prototype.rewrite_=function(){var a=this.setting_,b=this.event_,c=a.callbacks.update;a.rewrite&&this.util_.fire(c.rewrite.before,a,[b,a,this.srcDocument_,this.dstDocument_])!==!1&&(this.util_.fire(a.rewrite,a,[this.srcDocument_,this.area_,this.record_.data.host()]),this.util_.fire(c.rewrite.before,a,[b,a,this.srcDocument_,this.dstDocument_])===!1)},b.prototype.title_=function(){var a=this.setting_,b=this.event_,c=a.callbacks.update;this.util_.fire(c.title.before,a,[b,a,this.srcDocument_.title,this.dstDocument_.title])!==!1&&(this.dstDocument_.title=this.srcDocument_.title,this.util_.fire(c.title.after,a,[b,a,this.srcDocument_.title,this.dstDocument_.title])===!1)},b.prototype.head_=function(){var a=this.setting_,b=this.event_,c=this.srcDocument_,d=this.dstDocument_,e=a.callbacks.update;if(a.load.head&&this.util_.fire(e.head.before,a,[b,a,this.srcDocument_.querySelector("head"),this.dstDocument_.querySelector("head")])!==!1){for(var f,g="base, meta, link",h=jQuery(c.head).children(g).filter(a.load.head).not(a.load.ignore).not('link[rel~="stylesheet"], style, script'),i=jQuery(d.head).children(g).filter(a.load.head).not(a.load.ignore).not('link[rel~="stylesheet"], style, script'),j=jQuery(),k=i,l=0;f=h[l];l++){for(var m=0;k[m];m++)if(k[m].tagName===f.tagName&&k[m].outerHTML===f.outerHTML){if(j.length){var n=i[i.index(k[m])-1];n?jQuery(n).after(j.clone()):k.eq(m).before(j.clone()),j=jQuery()}k=k.not(k[m]),f=null;break}j=j.add(f)}jQuery("title",d).before(j.clone()),k.remove(),this.util_.fire(e.head.after,a,[b,a,this.srcDocument_.querySelector("head"),this.dstDocument_.querySelector("head")])===!1}},b.prototype.content_=function(){function b(){var a=jQuery.Deferred();return jQuery(this).one("load error",a.resolve),a}var c,d=this,e=this.setting_,f=this.event_,g=this.srcDocument_,h=this.dstDocument_,i=e.callbacks.update;if(this.util_.fire(i.content.before,e,[f,e,jQuery(this.area_,this.srcDocument_).get(),jQuery(this.area_,this.dstDocument_).get()])!==!1){jQuery(this.area_).children("."+e.nss.class4html+"-check").remove(),c=jQuery("<div/>",{"class":e.nss.class4html+"-check",style:"background: none !important; display: block !important; visibility: hidden !important; position: absolute !important; top: 0 !important; left: 0 !important; z-index: -9999 !important; width: auto !important; height: 0 !important; margin: 0 !important; padding: 0 !important; border: none !important; font-size: 12px !important; text-indent: 0 !important;"}).text(a.DEF.NAME);for(var j,k,l=0;this.areas_[l];l++){if(j=jQuery(this.areas_[l],g).clone(),k=jQuery(this.areas_[l],h),!j.length||!k.length||j.length!==k.length)throw new Error("throw: area mismatch");j.find("script").each(function(a,b){return d.escapeScript_(b)}),jQuery.when&&(this.loadwaits_=this.loadwaits_.concat(j.find("img, iframe, frame").map(b).get()));for(var m=0;j[m];m++)k[m].parentNode.replaceChild(j[m],k[m]);k=jQuery(this.areas_[l],h),k.append(c.clone()),k.find("script").each(function(a,b){return d.restoreScript_(b)})}this.dispatchEvent(document,a.DEF.NAME+":DOMContentLoaded",!1,!1),this.util_.fire(i.content.after,e,[f,e,jQuery(this.area_,this.srcDocument_).get(),jQuery(this.area_,this.dstDocument_).get()])===!1}},b.prototype.balance_=function(){var a=this.setting_,b=this.event_,c=a.callbacks.update;if(a.balance.self&&!(this.app_.loadtime<100)){var d=this.record_.data.jqXHR(),e=d.getResponseHeader(a.balance.server.header)||"",f=Math.ceil(this.app_.loadtime/(d.responseText.length||1)*1e5);this.util_.fire(c.balance.before,a,[b,a,e,this.app_.loadtime,d.responseText.length])!==!1&&(this.app_.data.saveServer(e,f),this.app_.balance.changeServer(this.app_.balance.chooseServer(a),a),this.util_.fire(c.balance.after,a,[b,a,e,this.app_.loadtime,d.responseText.length])===!1)}},b.prototype.css_=function(a){function b(){return jQuery.contains(f.head,this)}function c(){return jQuery.contains(f.body,this)}var d=this.setting_,e=this.event_,f=this.srcDocument_,g=this.dstDocument_,h=d.callbacks.update;if(d.load.css){var i="link, style",j=jQuery(i,f).filter(a).not(jQuery("noscript",f).find(i)),k=jQuery(i,g).filter(a).not(jQuery("noscript",f).find(i)),l=jQuery(),m=k;if(this.util_.fire(h.css.before,d,[e,d,j.get(),k.get()])!==!1){j=j.not(d.load.ignore),k=j.not(d.load.ignore);for(var n,o=0;n=j[o];o++){for(var p,q=0;m[q];q++){switch(n.tagName.toLowerCase()){case"link":p=n.href===m[q].href;break;case"style":p=this.util_.trim(n.innerHTML)===this.util_.trim(m[q].innerHTML)}if(p){if(l.length){if(jQuery.contains(g.body,m[q])&&l.first().parents("head").length)jQuery(g.head).append(l.filter(b).clone()),m.eq(q).before(l.filter(c).clone());else{var r=k[k.index(m[q])-1];r?jQuery(r).after(l.clone()):m.eq(q).before(l.clone())}l=jQuery()}m=m.not(m[q]),q-=Number(!!q),n=null;break}}l=l.add(n)}if(jQuery(g.head).append(l.filter(b).clone()),jQuery(g.body).append(l.filter(c).clone()),m.remove(),k=jQuery(i,g).filter(a).not(jQuery("noscript",f).find(i)),this.util_.fire(h.css.after,d,[e,d,j.get(),k.get()])!==!1){var s=d.speedcheck,t=this.model_.speed;s&&t.time.push(t.now()-t.fire),s&&t.name.push("css("+t.time.slice(-1)+")")}}}},b.prototype.script_=function(a){var b=this,c=this.setting_,d=this.event_,e=this.srcDocument_,f=this.dstDocument_,g=c.callbacks.update,h=[],i=[];if(!c.load.script)return h;var j="script",k=jQuery(j,e).filter(a).not(jQuery("noscript",e).find(j)),l=jQuery(j,f).filter(a).not(jQuery("noscript",f).find(j)),m=this.app_.page.loadedScripts,n=/^$|(?:application|text)\/(?:java|ecma)script/i,o=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g;if(this.util_.fire(g.script.before,c,[d,c,k.get(),l.get()])===!1)return h;k=k.not(c.load.ignore);for(var p,q=function(a,d){if(!b.util_.compareUrl(b.model_.convertUrlToKeyUrl(c.destLocation.href),b.model_.convertUrlToKeyUrl(window.location.href),!0))return!1;a.src&&(m[a.src]=!c.load.reload||!jQuery(a).is(c.load.reload));try{if(b.model_.isDeferrable){if("string"!=typeof d)throw d;eval.call(window,d)}else a.hasAttribute("src")?jQuery.ajax(jQuery.extend(!0,{},c.ajax,c.load.ajax,{url:a.src,dataType:"script",async:!1,global:!1,success:function(){return null},error:function(a){throw a}})):eval.call(window,(a.text||a.textContent||a.innerHTML||"").replace(o,""));try{a.hasAttribute("src")&&b.dispatchEvent(a,"load",!1,!1)}catch(e){}}catch(f){try{a.hasAttribute("src")&&b.dispatchEvent(a,"error",!1,!1)}catch(e){}if(!0===c.load.error)throw f;b.util_.fire(c.load.error,c,[f,a])}},r=0;p=k[r];r++)if(n.test(p.type||"")&&(p.hasAttribute("src")?!m[p.src]:this.util_.trim(p.innerHTML))){var s=jQuery(p).parent(c.load.log)[0];if(s&&!jQuery(p).parents(this.area_).length){var t=jQuery(s.id||s.tagName,f)[0],u=p.cloneNode(!0);this.escapeScript_(u),t.appendChild(u),this.restoreScript_(u)}!function(a){var d=b.model_.isDeferrable&&jQuery.Deferred();a.hasAttribute("src")&&a.getAttribute("src")?(m[a.src]=!c.load.reload||!jQuery(a).is(c.load.reload),a.hasAttribute("async")?jQuery.ajax(jQuery.extend({},c.ajax,c.load.ajax,{url:a.src,dataType:"script",async:!0,global:!1,success:function(){return b.dispatchEvent(a,"load",!1,!1)},error:function(){return b.dispatchEvent(a,"error",!1,!1)}})):d?(jQuery.ajax(jQuery.extend({},c.ajax,c.load.ajax,{url:a.src,dataType:"text",async:!0,global:!1,success:function(){return d.resolve([a,arguments[0]])},error:function(b){return d.resolve([a,b])}})),h.push(d)):i.push(a)):a.hasAttribute("src")||(d?h.push(d.resolve([a,(a.text||a.textContent||a.innerHTML||"").replace(o,"")])):i.push(a))}(p)}try{this.model_.isDeferrable?jQuery.when.apply(jQuery,h).always(function(){return jQuery.each(arguments,function(a,c){return q.apply(b,c)})}):jQuery.each(i,function(a,b){return q(b)})}catch(v){throw setTimeout(function(){return b.model_.fallback(d)},1),v}if(l=jQuery(j,f).filter(a).not(jQuery("noscript",f).find(j)),this.util_.fire(g.script.after,c,[d,c,k.get(),l.get()])===!1)return h;var w=c.speedcheck,x=this.model_.speed;return w&&x.time.push(x.now()-x.fire),w&&x.name.push("script("+x.time.slice(-1)+")"),h},b.prototype.scroll_=function(b){var c=this.setting_,d=this.event_,e=c.callbacks.update;if(this.util_.fire(e.scroll.before,c,[d,c])!==!1){var f,g;switch(d.type.toLowerCase()){case a.EVENT.CLICK:case a.EVENT.SUBMIT:f=b&&"function"==typeof c.scrollLeft?this.util_.fire(c.scrollLeft,c,[d,c,c.origLocation.cloneNode(),c.destLocation.cloneNode()]):c.scrollLeft,f=f>=0?f:0,f=f===!1||null===f?jQuery(window).scrollLeft():parseInt(Number(f)+"",10),g=b&&"function"==typeof c.scrollTop?this.util_.fire(c.scrollTop,c,[d,c,c.origLocation.cloneNode(),c.destLocation.cloneNode()]):c.scrollTop,g=g>=0?g:0,g=g===!1||null===g?jQuery(window).scrollTop():parseInt(Number(g)+"",10),window.scrollTo(f,g);break;case a.EVENT.POPSTATE:b&&c.fix.scroll&&this.app_.data.loadScrollPosition()}b&&this.app_.data.saveScrollPosition(),this.util_.fire(e.scroll.after,c,[d,c])===!1}},b.prototype.waitRender_=function(a){function b(){return this.clientWidth||this.clientHeight||jQuery(this).is(":hidden")}var c=this,d=this.setting_,e=(this.event_,d.callbacks.update,jQuery(this.area_)),f=e.children("."+d.nss.class4html+"-check"),g=(new Date).getTime()+5e3,h=function(){switch(!0){case!c.util_.compareUrl(d.destLocation.href,c.util_.normalizeUrl(window.location.href)):break;case(new Date).getTime()>g:case f.length!==e.length:case f.length===f.filter(b).length:f.remove(),a();break;default:setTimeout(h,100)}};return h(),jQuery.when&&a},b.prototype.scrollByHash_=function(a){if(a="#"===a.charAt(0)?a.slice(1):a,!a)return!1;var b=jQuery("#"+(a?a:", [name~="+a+"]")).first();return b.length?(isFinite(b.offset().top)&&window.scrollTo(jQuery(window).scrollLeft(),parseInt(Number(b.offset().top)+"",10)),this.app_.data.saveScrollPosition(),!0):!1},b.prototype.escapeNoscript_=function(a){function b(){jQuery(this).text(this.innerHTML)}jQuery("noscript",a).children().parent().each(b)},b.prototype.restoreNoscript_=function(a){var b=jQuery("<span/>");return a.replace(/(<noscript>)([^<>]+?)(<\/noscript>)/gim,function(a,c,d,e){return c+b.html(d).text()+e})},b.prototype.escapeScript_=function(a){jQuery.data(a,"source",a.src),jQuery.data(a,"code",a.innerHTML),a.removeAttribute("src"),a.innerHTML=""},b.prototype.restoreScript_=function(a){undefined!==jQuery.data(a,"code")&&(a.innerHTML=" ",jQuery.data(a,"source")?(a.src=jQuery.data(a,"source"),jQuery.removeData(a,"source")):a.removeAttribute("src"),a.innerHTML=jQuery.data(a,"code"),jQuery.removeData(a,"code"))},b.prototype.chooseArea=function(){},b.prototype.dispatchEvent=function(){},b}();b.PageUpdate=c}(c=b.APP||(b.APP={}))}(b=a.MODEL||(a.MODEL={}))}(MODULE||(MODULE={}));var MODULE;!function(a){var b;!function(b){var c;!function(b){var c=function(){function b(){}return b.prototype.test_=function(a){try{var b='<html lang="en" class="html"><head><title>&amp;</title><link href="/"><noscript><style>/**/</style></noscript></head><body><noscript>noscript</noscript><a href="/"></a></body></html>',c=this.parse(b,window.location.href,a);switch(!1){case!!c:case c.URL&&decodeURI(c.URL)===decodeURI(window.location.href):case"&"===c.title:case!!c.querySelector('html.html[lang="en"]'):case!!c.querySelector("head>link").href:case!!c.querySelector("head>noscript").innerHTML:case!!c.querySelector("body>noscript").innerHTML:case!!c.querySelector("body>a").href:throw!0}return a}catch(d){}},b.prototype.parse=function(b,c,d){function e(a,b){var c=document.createElement("div");c.innerHTML=b.match(/<html(?:\s.*?[^\\])?>|$/i).shift().replace(/html/i,"div")||"<div>";for(var d,e=c.firstChild.attributes,f=0;d=e[f];f++)a.documentElement.setAttribute(d.name,d.value);var c=document.createElement("html");for(c.innerHTML=b.replace(/^.*?<html(?:\s.*?[^\\])?>/im,""),a.documentElement.removeChild(a.head),a.documentElement.removeChild(a.body);c.childNodes.length;)a.documentElement.appendChild(c.childNodes[0]);return a}void 0===d&&(d=this.mode_),b+=~b.search(/<title[\s>]/i)?"":"<title></title>";var f=c&&a.LIBRARY.Utility.compareUrl(c,window.location.href)?undefined:window.location.href;f&&window.history.replaceState(window.history.state,document.title,c);var g;switch(d){case"dom":"function"==typeof window.DOMParser&&(g=(new window.DOMParser).parseFromString(b,"text/html"));break;case"doc":if(document.implementation&&document.implementation.createHTMLDocument){if(g=document.implementation.createHTMLDocument(""),"object"!=typeof g.activeElement||!g.activeElement)break;"function"==typeof window.DOMParser&&(new window.DOMParser).parseFromString("","text/html")&&(g.title=(new window.DOMParser).parseFromString(b.match(/<title(?:\s.*?[^\\])?>(?:.*?[^\\])?<\/title>/i),"text/html").title),g.open(),g.write(b),g.close(),g.title!==g.querySelector("title").textContent&&(g.title=g.querySelector("title").textContent)
}break;case"manipulate":document.implementation&&document.implementation.createHTMLDocument&&(g=e(document.implementation.createHTMLDocument(""),b));break;case null:g=null;break;default:switch(/webkit|firefox|trident|$/i.exec(window.navigator.userAgent.toLowerCase()).shift()){case"webkit":this.mode_=this.test_("doc")||this.test_("dom")||this.test_("manipulate");break;case"firefox":this.mode_=this.test_("dom")||this.test_("doc")||this.test_("manipulate");break;case"trident":this.mode_=this.test_("manipulate")||this.test_("dom")||this.test_("doc");break;default:this.mode_=this.test_("dom")||this.test_("doc")||this.test_("manipulate")}g=this.parse(b,c)}return f&&window.history.replaceState(window.history.state,document.title,f),g},b}();b.PageParser=c;var d=function(){function a(){a.instance_=a.instance_||new c}return a.prototype.singleton_=function(){return a.instance_},a.prototype.parse=function(a,b){return this.singleton_().parse(a,b)},a}();b.PageParserSingleton=d}(c=b.APP||(b.APP={}))}(b=a.MODEL||(a.MODEL={}))}(MODULE||(MODULE={}));var MODULE;!function(a){var b;!function(b){var c;!function(b){a.MIXIN(b.PageFetch,[b.PageUtility]),a.MIXIN(b.PageUpdate,[b.PageUtility]);var c=function(){function c(c,d){var e=this;this.model_=c,this.app_=d,this.util_=a.LIBRARY.Utility,this.parser=new b.PageParserSingleton,this.provider=new b.PageProvider(b.PageRecord,this.model_,this.app_),this.landing=this.util_.normalizeUrl(window.location.href),this.loadedScripts={},setTimeout(function(){return e.parser.parse("")||e.model_.disable()},300)}return c.prototype.transfer=function(b,c){switch(c.type.toLowerCase()){case a.EVENT.CLICK:this.app_.data.saveTitle(),this.app_.data.saveScrollPosition();break;case a.EVENT.SUBMIT:this.app_.data.saveTitle(),this.app_.data.saveScrollPosition();break;case a.EVENT.POPSTATE:this.app_.data.saveTitle(b.origLocation.href,document.title),b.fix.history&&this.app_.data.loadTitle()}b=jQuery.extend(!0,{},b),b.origLocation=b.origLocation.cloneNode(),b.destLocation=b.destLocation.cloneNode(),b=a.FREEZE(b),this.fetch_(b,c)},c.prototype.getWait=function(){return this.wait_},c.prototype.setWait=function(a){return this.wait_&&this.wait_.state&&"pending"===this.wait_.state()&&this.wait_.reject(),this.wait_=a},c.prototype.fetch_=function(a,b){var c=this;this.provider.fetchRecord(a,b,function(a,b,d){return c.success_(a,b,d)},function(a,b,d){return c.failure_(a,b,d)})},c.prototype.success_=function(a,c,d){new b.PageUpdate(this.model_,this.app_,c,d,a)},c.prototype.failure_=function(a,b,c){b.fallback&&"abort"!==a.data.textStatus()&&(b.balance.self&&(this.app_.data.saveServer(a.data.host(),0,(new Date).getTime()),this.app_.balance.changeServer(this.app_.balance.chooseServer(b),b)),this.model_.fallback(c))},c.prototype.chooseArea=function(){},c.prototype.dispatchEvent=function(){},c}();b.Page=c}(c=b.APP||(b.APP={}))}(b=a.MODEL||(a.MODEL={}))}(MODULE||(MODULE={}));var MODULE;!function(MODULE){var MODEL;!function(MODEL){var APP;!function(APP){MODULE.MIXIN(APP.Page,[APP.PageUtility]);var Main=function(){function Main(a,b){this.model_=a,this.controller_=b,this.util_=MODULE.LIBRARY.Utility,this.settings_={},this.balance=new APP.Balance(this.model_,this),this.page=new APP.Page(this.model_,this),this.data=new APP.Data(this.model_,this),this.count=0,this.time=(new Date).getTime(),this.loadtime=0}return Main.prototype.initialize=function(a,b){var c=this;if(b.load.script){var d=this.page.loadedScripts;jQuery("script").each(function(){var a=this;a.src&&(d[a.src]=!b.load.reload||!jQuery(a).is(b.load.reload))})}this.controller_.view(a,b),setTimeout(function(){return c.data.loadBuffers(b.buffer.limit)},b.buffer.delay),setTimeout(function(){return c.balance.enable(b)},b.buffer.delay),setTimeout(function(){return c.page.landing=null},1500)},Main.prototype.configure=function(destination){var event=destination.preventDefault?destination:null;switch(event&&"object"==typeof event&&event.type.toLowerCase()){case MODULE.EVENT.CLICK:return this.configure(event.currentTarget);case MODULE.EVENT.SUBMIT:return this.configure(event.currentTarget);case MODULE.EVENT.POPSTATE:return this.configure(window.location);case null:}var url;switch(!0){case"string"==typeof destination:url=destination;break;case"href"in destination:url=this.util_.normalizeUrl(destination.href);break;case"action"in destination:switch(url=this.util_.normalizeUrl(destination.action.replace(/[?#].*/,"")),destination.method.toUpperCase()){case"GET":url+="?"+jQuery(destination).serialize()}break;default:url=this.model_.location.href,this.option_=destination}var index=[this.util_.canonicalizeUrl(this.model_.location.href).slice(0,2048),this.util_.canonicalizeUrl(url).slice(0,2048)].join(" ");if(!this.option_)return null;if(index in this.settings_)return this.settings_[index];var origLocation=this.model_.location.cloneNode(),destLocation=this.model_.location.cloneNode();destLocation.href=url;var scope=this.scope_(this.option_,origLocation.href,destLocation.href)||null,initial={area:"body",link:"a:not([target])",filter:function(){return/^https?:/.test(this.href)&&/\/[^.]*$|\.(html?|php)$/.test(this.pathname.replace(/^\/?/,"/"))},form:null,scope:null,rewrite:null,state:null,scrollTop:0,scrollLeft:0,ajax:{dataType:"text"},contentType:"text/html",redirect:!0,cache:{click:!1,submit:!1,popstate:!1,get:!0,post:!0,mix:0,limit:100,expires:{max:null,min:3e5}},buffer:{limit:30,delay:500},load:{head:"",css:!1,script:!1,ignore:'[src*="jquery.js"], [src*="jquery.min.js"], [href^="chrome-extension://"]',reload:"",execute:!0,log:"head, body",error:!0,ajax:{dataType:"script",cache:!0}},balance:{self:!1,weight:3,option:{server:{header:!1},ajax:{crossDomain:!0},callbacks:{ajax:{beforeSend:null}}},client:{support:{userAgent:/msie|trident.+ rv:|chrome|firefox|safari/i,redirect:/chrome|firefox|safari/i},exclude:/mobile|phone|android|iphone|blackberry/i,cookie:{balance:"ajax_balanceable",redirect:"ajax_redirectable",host:"ajax_host"}},server:{header:"X-Ajax-Host",filter:null,respite:6e5},history:{expires:864e6,limit:30}},wait:0,fallback:!0,reset:{type:"",count:100,time:108e5},fix:{location:!0,history:!0,scroll:!0,noscript:!0},database:!0,server:{query:null,header:!0},callback:null,callbacks:{ajax:{},update:{redirect:{},url:{},rewrite:{},title:{},head:{},content:{},scroll:{},css:{},script:{},balance:{}}},data:undefined},force={ns:undefined,nss:undefined,speedcheck:undefined,origLocation:origLocation,destLocation:destLocation,scroll:{queue:[]},option:this.option_},compute=function(){setting.ns=setting.ns?setting.ns.split(".").sort().join("."):"";var nsArray=[MODULE.DEF.NAME].concat(setting.ns?setting.ns.split("."):[]),query=setting.server.query;switch(query&&typeof query){case"string":query=eval("({"+query.match(/[^?=&]+=[^&]*/g).join("&").replace(/"/g,'\\"').replace(/([^?=&]+)=([^&]*)/g,'"$1": "$2"').replace(/&/g,",")+"})");case"object":query=jQuery.param(query);break;default:query=""}return{ns:undefined,origLocation:undefined,destLocation:undefined,scroll:undefined,option:undefined,speedcheck:undefined,nss:{name:setting.ns||"",array:nsArray,event:nsArray.join("."),data:nsArray.join("-"),class4html:nsArray.join("-"),click:[MODULE.EVENT.CLICK].concat(nsArray.join(":")).join("."),submit:[MODULE.EVENT.SUBMIT].concat(nsArray.join(":")).join("."),popstate:[MODULE.EVENT.POPSTATE].concat(nsArray.join(":")).join("."),scroll:[MODULE.EVENT.SCROLL].concat(nsArray.join(":")).join("."),requestHeader:["X",nsArray[0].replace(/^\w/,function(a){return a.toUpperCase()})].join("-")},fix:/android|iphone os|like mac os x/i.test(window.navigator.userAgent)?undefined:{location:!1},contentType:setting.contentType.replace(/\s*[,;]\s*/g,"|").toLowerCase(),reset:{type:(setting.reset.type||"").toLowerCase()},server:{query:query},timeStamp:(new Date).getTime()}},setting;return setting=jQuery.extend(!0,initial,scope||this.option_),setting=jQuery.extend(!0,setting,setting.balance.self&&setting.balance.option,force),setting=jQuery.extend(!0,setting,compute()),scope?(MODULE.FREEZE(setting,!0),this.settings_[index]=setting,setting):(this.settings_[index]=null,null)},Main.prototype.scope_=function(a,b,c,d){if(void 0===d&&(d=""),a=jQuery.extend(!0,{},a),!a.scope)return a;var e,f,g,h,i,j,k,l=a.scope;if(e=this.model_.convertUrlToKeyUrl(b).match(/.+?\w(\/.*)/).pop(),f=this.model_.convertUrlToKeyUrl(c).match(/.+?\w(\/.*)/).pop(),d=d.replace(/[#?].*/,""),h=(d||f).split("/"),d){if(!~d.indexOf("*"))return undefined;g=[];for(var m=e.split("/"),n=0,o=h.length;o>n;n++)"*"===h[n]&&g.push(m[n])}for(var n=h.length;n--;)if(i=h.slice(0,n+1).join("/"),i+="/"===(d||e).charAt(i.length)?"/":"",i&&i in l){var p;if(l[i]instanceof Array?(j="",p=l[i]):(j=l[i],p=l[j]),p){p=p.concat();var q,r,s;s=k=q=r=undefined;for(var t,u=0;t=p[u];u++){if("#"===t.charAt(0)&&(j=t.slice(1),[].splice.apply(p,[u,1].concat(l[j])),t=p[u]),"inherit"===t)s=!0;else if("rewrite"!==t||"function"!=typeof l.rewrite||d){if("string"==typeof t){var v="!"===t.charAt(0);t=v?t.slice(1):t;var w="*"===t.charAt(0);if(t=w?t.slice(1):t,d&&~t.indexOf("/*/"))for(var x=0,o=g.length;o>x;x++)t=t.replace("/*/","/"+g[x]+"/");(w?~e.search(t):~e.indexOf(t))&&(q=v?!1:!0),(w?~f.search(t):~f.indexOf(t))&&(v?r=!1:(r=!0,k=l["$"+j]||l["$"+t]||undefined))}}else k=this.scope_(a,b,c,this.util_.fire(l.rewrite,null,[f])),k?q=r=!0:null===k&&(q=r=!1);if(!1===q||!1===r)return null}if(q&&r)return jQuery.extend(!0,a,k);if(!s)break}}return undefined},Main}();APP.Main=Main}(APP=MODEL.APP||(MODEL.APP={}))}(MODEL=MODULE.MODEL||(MODULE.MODEL={}))}(MODULE||(MODULE={}));var MODULE;!function(a){var b;!function(a){a.App=a.APP.Main}(b=a.MODEL||(a.MODEL={}))}(MODULE||(MODULE={}));var MODULE;!function(a){var b;!function(b){var c=function(c){function d(){c.call(this,1),this.controller_=new a.Controller(this).singleton(),this.app_=new b.App(this,this.controller_),this.util_=a.LIBRARY.Utility,this.isDeferrable=!!jQuery.when&&"1.006"<=jQuery().jquery.match(/\d[\d.]+\d/).pop().replace(/\.(\d+)/g,".00$1").replace(/0*(\d{3})/g,"$1"),this.location=document.createElement("a"),this.queue_=[]}return __extends(d,c),d.prototype.getRequestDomain=function(){return this.host()},d.prototype.setRequestDomain=function(a){return this.app_.balance.changeServer(a.split("//").pop())},d.prototype.host=function(){return this.app_.balance.host()},d.prototype.state=function(){return this.state_},d.prototype.main_=function(b,c){var d=this;switch(typeof c){case"object":b=b instanceof a.DEF.NAMESPACE?b:jQuery(document)[a.DEF.NAME](),a.FREEZE(c,!0);break;default:return b}if(!window.history||!window.history.pushState||!window.history.replaceState)return b;this.location.href=this.util_.normalizeUrl(window.location.href);var e=this.app_.configure(c);return e?(this.app_.data.connect(e),this.speed={fire:0,time:[],name:[],now:function(){return(new Date).getTime()}},jQuery(function(){d.app_.initialize(b,e),d.state_=1===d.state()?2:d.state()}),b):b},d.prototype.convertUrlToKeyUrl=function(a){return a.replace(/#.*/,"")},d.prototype.configure=function(a){return this.app_.configure(a)},d.prototype.isAvailable=function(b){if(2!==this.state())return!1;if(b.which>1||b.metaKey||b.ctrlKey||b.shiftKey||b.altKey)return!1;var c;switch(b.type.toLowerCase()){case a.EVENT.CLICK:if(c=this.app_.configure(b.currentTarget),c&&!jQuery(b.currentTarget).filter(c.filter).length)return!1;break;case a.EVENT.SUBMIT:c=this.app_.configure(b.currentTarget);break;case a.EVENT.POPSTATE:c=this.app_.configure(window.location)}return c?c.origLocation.protocol!==c.destLocation.protocol||c.origLocation.host!==c.destLocation.host?!1:c.destLocation.hash&&c.origLocation.href.replace(/#.*/,"")===c.destLocation.href.replace(/#.*/,"")?!1:this.app_.page.chooseArea(c.area,document,document)?!0:!1:!1},d.prototype.getXHR=function(){return this.app_.page.xhr},d.prototype.setXHR=function(a){return this.app_.page.xhr&&this.app_.page.xhr.readyState<4&&this.app_.page.xhr.abort(),this.app_.page.xhr=a},d.prototype.click=function(a){a:{a.timeStamp=(new Date).getTime();var b=a.currentTarget,c=(jQuery(b),this.app_.configure(b));switch(!1){case!a.isDefaultPrevented():case!!c:case 2===this.state():case this.isAvailable(a):break a}return this.app_.page.transfer(c,a),void a.preventDefault()}!a.originalEvent&&!a.isDefaultPrevented()&&!jQuery(document).has(b).length&&this.fallback(a)},d.prototype.submit=function(a){a:{a.timeStamp=(new Date).getTime();var b=a.currentTarget,c=(jQuery(b),this.app_.configure(b));switch(!1){case!a.isDefaultPrevented():case!!c:case 2===this.state():case this.isAvailable(a):break a}return this.app_.page.transfer(c,a),void a.preventDefault()}!a.originalEvent&&!a.isDefaultPrevented()&&!jQuery(document).has(b).length&&this.fallback(a)},d.prototype.popstate=function(a){a:{if(this.app_.page.landing&&this.app_.page.landing===this.util_.normalizeUrl(window.location.href))return;if(this.location.href===this.util_.normalizeUrl(window.location.href))return;a.timeStamp=(new Date).getTime();var b=this.app_.configure(window.location);if(b.origLocation.pathname+b.origLocation.search===b.destLocation.pathname+b.destLocation.search)return;switch(!1){case!!b:case 2===this.state():case this.isAvailable(a):break a}return void this.app_.page.transfer(b,a)}this.fallback(a)},d.prototype.scroll=function(){for(var a,b=this;a=this.queue_.shift();)clearTimeout(a);a=setTimeout(function(){for(;a=b.queue_.shift();)clearTimeout(a);b.util_.compareUrl(window.location.href,b.location.href)&&b.app_.data.saveScrollPosition()},300),this.queue_.push(a)},d.prototype.fallback=function(a){var b=this.configure(a);switch(!0){case b&&!b.fallback:case b&&!1===this.util_.fire(b.fallback,b,[a,b,b.origLocation.cloneNode(),b.destLocation.cloneNode()]):break;default:this.movePageNormally_(a)}},d.prototype.movePageNormally_=function(b){switch(b.type.toLowerCase()){case a.EVENT.CLICK:window.location.assign(b.currentTarget.href);break;case a.EVENT.SUBMIT:switch(b.currentTarget.method.toUpperCase()){case"GET":window.location.assign(b.currentTarget.action.replace(/[?#].*/,"")+"?"+jQuery(b.currentTarget).serialize());break;case"POST":window.location.assign(b.currentTarget.action)}break;case a.EVENT.POPSTATE:window.location.reload()}},d.prototype.enable=function(){this.state_=2},d.prototype.disable=function(){this.state_=3},d.prototype.getCache=function(a){var b=this.configure(this.convertUrlToKeyUrl(a));if(b){var c=this.app_.page.provider.getRecord(b);return c.data.data()||c.data.jqXHR()?{data:c.data.data(),textStatus:c.data.textStatus(),jqXHR:c.data.jqXHR(),expires:c.data.expires(b.cache.expires.min,b.cache.expires.max),host:c.data.host()}:undefined}},d.prototype.setCache=function(a,b,c,d){var e=this.configure(this.convertUrlToKeyUrl(a));if(e){var f=this.app_.page.provider.getRecord(e);this.app_.page.provider.setRecord(e,b||"",c||f.data.textStatus(),d||f.data.jqXHR(),f.data.host())}},d.prototype.removeCache=function(a){var b=this.configure(this.convertUrlToKeyUrl(a));b&&this.app_.page.provider.removeRecord(b)},d.prototype.clearCache=function(){this.app_.page.provider.clearRecord()},d}(b.Template);b.Main=c;var d=function(){function a(){a.instance_=a.instance_||new c}return a.singleton=function(){return a.instance_},a.prototype.singleton=function(){return a.singleton()},a}();b.Singleton=d}(b=a.MODEL||(a.MODEL={}))}(MODULE||(MODULE={}));var MODULE;!function(a){a.Model=a.MODEL.Singleton}(MODULE||(MODULE={}));var Module=function(){function a(){new MODULE.Model}return a}();new Module}(window,window.document,void 0,jQuery);

$(function(){
	$.pjax({
		area : '#mainContent',
		link : 'a:not([target])',
		ajax : { timeout: 3000 }, 
		wait : 500
	});
	$(document).bind('pjax:fetch', function () {
		$('div.loading').fadeIn(100);
		$('#mainContent').animate({opacity: 0},500);
		if(flag) {
			$("#wrapper,#header").animate({right: "0"});
			$("#navigation").animate({right: "-250px"});
			$("#menuBtn").css({opacity:1});
			flag=0;
		};
	});
	$(document).bind('pjax:render', function () {
		$('div.loading').fadeOut(300);
		$('#mainContent ').animate({opacity : 1},500);
		if(document.getElementById("mapCanvas")){
			googleMap();
		};
		if(document.getElementById("pageTop")){
			setSize();
		};

		// twitter 
		if(!window.twttr){
		$('#mainContent').append('<a href="https://twitter.com/share" class="twitter-share-button" data-lang="en"></a>');
		var twitterjs = document.createElement("script");
		twitterjs.async = true;
		twitterjs.src = '//platform.twitter.com/widgets.js';
		document.getElementsByTagName('body')[0].appendChild(twitterjs);
		}else{
			$('#mainContent .twitter-share-button').replaceWith('<a href="https://twitter.com/share" class="twitter-share-button" data-lang="en" data-url="' + encodeURI(location.href) + '" data-text="' + document.title + '"></a>');
			twttr.widgets.load();
		};
		// facebook 
		if(!window.FB){
		$('#mainContent').append('<div id="fb-root"></div><div class="fb-like" data-href="' + encodeURI(location.href) + '" data-width="90" data-height="20" data-colorscheme="light" data-layout="button_count" data-action="like" data-show-faces="false" data-send="false"></div>');
		var fbjs = document.createElement("script");
		fbjs.id = "facebook-jssdk";
		fbjs.src = "//connect.facebook.net/ja_JP/all.js#xfbml=1&appId=1403325069884499";
		document.getElementsByTagName('body')[0].appendChild(fbjs);
		}else{
			$('#mainContent .fb-like').attr('data-href', encodeURI(location.href));
			FB.XFBML.parse();
		}
	});
});